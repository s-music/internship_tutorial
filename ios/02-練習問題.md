## 課題1

ここまでで作った計算機アプリでは、割り算を行なった際に、3つ目のテキストボックスの値が0になるとアプリが停止してしまいます。<br>
これを解決する為に3つ目のテキストボックスの値を判定し、0の場合はラベルにエラーを表示するように修正を行なってください。<br>


## 繰り返し処理

ここでもう一つ重要な構文について触れておきましょう。<br>
ある処理を複数回繰り返す際に用いるfor in文です。<br>
以下のようにコードを編集し、実行しててください。<br>

```swift
@IBAction func onPushButton(_ sender: Any) {
  let num1 = Int(textField.text ?? "") ?? 0
  let num2 = Int(textField2.text ?? "") ?? 0
  for i in 0..<num2 {
    print("\(i): \(num1)") // "\(変数名)"で変数を文字列中に埋め込むことができる
  }
}
```

動作を確認してみると、ボタンを押した際に2つ目のテキストボックスに入力した回数分1つ目のテキストボックスに入力した値がデバッグエリアに表示されます。<br>
改めてコードを確認してみると、`for i in 0..<num2`の部分は0からnum2まで(num2は含めない)の数値を順番にiという変数に代入するという意味で、<br>
{}で囲われた部分は変数iに値が代入されるたびに実行される処理を表しています。<br>
`0..<num2`の部分は`0...num2`とすることもでき、この場合、0からnum2も含めた数値が順番に変数iに代入されます。<br>
また、{}で囲われた部分の処理中に変数iが必要ない場合、`for _ in 0..<num`として変数を省略することも可能です。<br>
<br>
この構文を利用して、以下の課題に取り組んでみてください。<br>

## 課題2

ここまでで作った計算機アプリに累乗を求める機能を追加してください。<br>
演算子に"^"が入力された場合に、1つ目のテキストボックスの数値を2つ目のテキストボックスに入力された数値分かけた値をラベルに表示します。<br>
<br>
ヒント:<br>
計算途中の値を保持しておく必要があるため、変数を利用しますが、一度値を設定した変数に別の値を設定したい場合、<br>
`let 変数名`で変数定義を行うのではなく、`var 変数名`として変数を定義します。<br>

## 関数

ここまでで、onPushButton内のコードがかなり長くなってしまったと思います。<br>
プログラミングではこうしたコードを分割して、名前をつけて処理を小分けにする<font color="red">関数定義</font>という機能が存在します。<br>
小分けにした処理は別の部分からも実行可能であり、処理の再利用が可能となります。<br>
関数にはインプット(<font color="red">引数</font>)とアウトプット(<font color="red">戻り値</font>)が存在し、<br>
処理を実行する前にパラメータとして引数を渡し、処理の結果を戻り値として受け取ることが可能です。<br>
ここでは関数定義の例として、onPushButtonの処理中から、受け取った文字列に応じた演算を行う処理を関数に切り出してみます。<br>
以下のようにコードを修正してください。<br>

```swift
// 省略

@IBAction func onPushButton(_ sender: Any) {
  let num1 = Int(textField.text ?? "") ?? 0
  let op = textField2.text ?? ""
  let num2 = Int(textField3.text ?? "") ?? 0
  label.text = calculate(num1, num2, op: op) // 3.関数の呼び出し
}

// 1. func 関数名(func 関数名(引数列挙) -> 戻り値の型 {}
func calculate(_ num1: Int,  _ num2: Int, op: String) -> String { 
  // 2. 各演算の処理結果をreturnによって呼び出し元に返却
  if (op == "+") { // opと+が同一の値かどうか比較を行なっている
    return String(num1 + num2)
  } else if (op == "-") {
    return String(num1 - num2)
  } else if (op == "*") {
    return String(num1 * num2)
  } else if (op == "/") {
    return String(num1 / num2)
  } else {
    return "エラー"
  }
}

// 省略
```

swiftの関数は`func 関数名(func 関数名(引数列挙) -> 戻り値の型 {}`としてコード中に記述し、{}内に処理を記述します。<br>
戻り値は`return 戻り値`と記述し、呼び出し元ではそれを変数などに代入することによって後続の処理に使用することができます。<br>
引数名は_(アンダースコア)頭につけて定義することによって呼び出し元で引数を設定する際に省略することがきます。<br>
これで、処理を切り出すことができ、onPushButton内の処理もスリムにすることができました。<br>
しかし、関数calculateの再利用性を考えた場合、引数が文字列だと使い勝手が悪いかもしれません。(calulateの値を使って別の計算を行う場合など)<br>
そこで、戻り値の値を整数値にしてみましょう。ただし、失敗した場合も考え、戻り値はOptionalの値とします。<br>

```swift
// 省略

@IBAction func onPushButton(_ sender: Any) {
  let num1 = Int(textField.text ?? "") ?? 0
  let op = textField2.text ?? ""
  let num2 = Int(textField3.text ?? "") ?? 0
  // 2. if let文。オプショナルバインディングと呼ばれる。
  if let reuslt = calculate(num1, num2, op: op) {
    // 演算が成功した場合、変数resultに値が代入され、{}で使用可能となる。
    label.text = String(result)
  } else {
    // 演算が失敗した場合、こちらが実行される。
    label.text = "エラー"
  }
}

func calculate(_ num1: Int,  _ num2: Int, op: String) -> Int? { // 1.戻り値をOptional Intに変更ß
  if (op == "+") { 
    return num1 + num2
  } else if (op == "-") {
    return num1 - num2
  } else if (op == "*") {
    return num1 * num2
  } else if (op == "/") {
    return num1 / num2
  } else {
    return nil // 失敗した場合は値なしを表すnilを返却する。
  }
}

// 省略
```

関数呼び出しの部分で使っている構文は<font color="red">if let文</font>と呼ばれる構文で、<br>
letで定義した変数に値が入っていた場合、if節を、入っていなかった場合else節を実行します。<br>
